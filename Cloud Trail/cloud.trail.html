<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudTrail</title>
    <style>
      body {
          font-family: 'Arial', sans-serif;
          line-height: 1.6;
          margin: 0;
          padding: 0;
          background-color: #f8f8f8; /* Light Grey Color */
      }
  
      header {
          max-width: 1500px;
          color: #fff;
          padding: 20px;
          background-color: #6495ED;
          border-radius: 8px;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
          text-align: center; /* Center content horizontally */
      }
  
      section {
          max-width: 1150px;
          margin: 20px auto;
          padding: 20px;
          background-color: #ffffff;
          border-radius: 8px;
          box-shadow: 0 0 10px rgba(23, 18, 93, 0.1);
      }
  
      h2 {
          color: #050505;
          font-size: 1.0em;
          margin-bottom: 10px;
      }
  
      .or {
          font-weight: bold;
          margin: 0 10px; /* Adjusted margin */
      }
  
      pre {
          font-family: 'Arial', monospace;
          background-color: #f8f8f8;
          padding: 10px;
          border: 1px solid #ddd;
          overflow-x: auto;
      }
  
      p {
          color: #0e0e0e;
      }
  
      ol {
          color: #111010;
          padding-left: 20px;
      }
  
      a {
          color: #0066cc;
          text-decoration: none;
      }
  
      th, td {
          border: 1px solid #dddddd;
          text-align: left;
          padding: 8px;
      }

      th {
            background-color: #f2f2f2;
        }
  
      dl {
          margin-bottom: 20px;
      }
  
      dt {
          font-weight: bold;
      }
  
      dd {
          margin-left: 20px;
      }
  
      .lb-h1 {
          /* Add styles for the h1 element */
          text-align: center; /* Center-align the heading */
      }
  
      .center-image {
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100vh; /* Optional: Adjust the height as needed */
      }
  
      body {
          font-family: Arial, sans-serif;
          margin: 20px;
      }
  
      li {
          margin-bottom: 10px;
      }
  
      .free-tier {
          background-color: #f0f8ff;
          padding: 10px;
          border-radius: 5px;
      }       
  </style>B
    
</head>
<body>

    <div class="lb-transition-wrapper lb-transition-fade-in lb-active" data-lb-comp="transition-wrapper" data-lb-comp-registered="true">
        <div class="lb-none-pad lb-grid lb-row lb-row-max-large lb-snap" style="display: flex; align-items: center;">
            <div class="lb-col lb-tiny-24 lb-mid-24">
                <div class="lb-bg-left-top-cover lb-border-p lb-small-pad lb-box" style="padding-left: 180px; padding-right: 180px; padding-bottom: 0px; background-image: url('https://s3.cn-north-1.amazonaws.com.cn/aws-dam-prod/tmt/template/GSRC_Tutorials_Congratulations.08882b89ba8adfe231cdb223e7ccfb462038399f.png'); background-color: #ffffff;">
                    <h1 id="Congratulations.21" class="lb-tiny-align-center lb-small-align-center lb-mid-align-center lb-large-align-center lb-xlarge-align-center lb-txt-none lb-txt-white lb-h1 lb-title">AWS CloudTrail</h1>
                    <div class="lb-grid lb-row lb-row-max-large lb-snap" style="padding-top: 0px; margin-top: 0px;">
                        <div class="lb-col lb-tiny-24 lb-mid-6">
                        </div>
                        <div class="lb-col lb-tiny-24 lb-mid-12" style="display: flex; flex-direction: column; justify-content: center; align-items: center;">
                            <div class="lb-tiny-align-center lb-small-align-center lb-mid-align-center lb-large-align-center lb-txt-16 lb-rtxt" style="color: #0d0d0d; margin-top: 0px;">
                                <p style="color: #0d0d0d; font-weight: bold;">
                                  "AWS CloudTrail is a service for logging AWS API calls, providing audit trails for compliance, security, and operational monitoring within AWS environments."</p>
                            </div>
                        </div>
                        <div class="lb-col lb-tiny-24 lb-mid-6">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <section>
        <h1>AWS CloudTrail</h1>
  <p>AWS CloudTrail is an AWS service that helps you enable operational and risk auditing, governance, and compliance of your AWS account. Actions taken by a user, role, or an AWS service are recorded as events in CloudTrail. Events include actions taken in the AWS Management Console, AWS Command Line Interface, and AWS SDKs and APIs.</p>
  <p>CloudTrail is active in your AWS account when you create it and doesn't require any manual setup. When activity occurs in your AWS account, that activity is recorded in a CloudTrail event.</p>
  <p>CloudTrail provides three ways to record events:</p>
  <ul>
    <li><strong>Event history:</strong><p>The Event history provides a viewable, searchable, downloadable, and immutable record of the past 90 days of management events in an AWS Region. You can search events by filtering on a single attribute. You automatically have access to the Event history when you create your account. For more information, see Working with CloudTrail Event history.</li></p>
    <li><strong>CloudTrail Lake:</strong><p>AWS CloudTrail Lake is a managed data lake for capturing, storing, accessing, and analyzing user and API activity on AWS for audit and security purposes. CloudTrail Lake converts existing events in row-based JSON format to Apache ORC format. ORC is a columnar storage format that is optimized for fast retrieval of data. Events are aggregated into event data stores, which are immutable collections of events based on criteria that you select by applying advanced event selectors. You can keep the event data in an event data store for up to 3,653 days (about 10 years) if you choose the One-year extendable retention pricing option, or up to 2,557 days (about 7 years) if you choose the Seven-year retention pricing option. You can create an event data store for a single AWS account or for multiple AWS accounts by using AWS Organizations. You can import any existing CloudTrail logs from your S3 buckets into an existing or new event data store. You can also visualize top CloudTrail event trends with Lake dashboards. For more information, see Working with AWS CloudTrail Lake and Create an event data store.</p>
        <p>CloudTrail Lake event data stores and queries incur charges. When you create an event data store, you choose the pricing option you want to use for the event data store. The pricing option determines the cost for ingesting and storing events, and the default and maximum retention period for the event data store. When you run queries in Lake, you pay based upon the amount of data scanned. For information about CloudTrail pricing and managing Lake costs, see AWS CloudTrail Pricing and Managing CloudTrail Lake costs.</p></li>
    <li><strong>Trails:</strong> <p>Trails capture a record of AWS activities, delivering and storing these events in an Amazon S3 bucket, with optional delivery to Amazon CloudWatch Logs and Amazon EventBridge. You can input these events into your security monitoring solutions. You can also use your own third-party solutions or solutions such as Amazon Athena to search and analyze your CloudTrail logs. You can create trails for a single AWS account or for multiple AWS accounts by using AWS Organizations. You can log Insights events to analyze your management events for anomalous behavior in API call volumes and error rates. For more information, see Creating a trail for your AWS account.</p>
        <p>You can deliver one copy of your ongoing management events to your Amazon S3 bucket at no charge from CloudTrail by creating a trail, however, there are Amazon S3 storage charges. For more information about CloudTrail pricing, see AWS CloudTrail Pricing. For information about Amazon S3 pricing, see Amazon S3 Pricing.</p>
        <p>Visibility into your AWS account activity is a key aspect of security and operational best practices. You can use CloudTrail to view, search, download, archive, analyze, and respond to account activity across your AWS infrastructure. You can identify who or what took which action, what resources were acted upon, when the event occurred, and other details to help you analyze and respond to activity in your AWS account.</p>
        <p>You can integrate CloudTrail into applications using the API, automate trail or event data store creation for your organization, check the status of event data stores and trails you create, and control how users view CloudTrail events.</p>
    </li>
  </ul>
    </section>

    <section>
        <h1>How CloudTrail works</h1>
        <p>CloudTrail is active in your AWS account when you create it. When activity occurs in your AWS account, that activity is recorded in a CloudTrail event. You can view the past 90 days of recorded API activity (management events) in an AWS Region in the CloudTrail console by going to Event history.</p>
  <p>For an ongoing record of events in your AWS account, create an event data store or a trail. Trails can log events for CloudTrail management, data, and Insights events. Event data stores can log CloudTrail management and data events, CloudTrail Insights events, AWS Config configuration items, AWS Audit Manager evidence, and non-AWS events from integrations.</p>
 
   <h1>Supported Regions</h1>
  <table>
    <tr>
      <th>Region Name</th>
      <th>Region</th>
      <th>Control Plane Endpoint</th>
      <th>Protocol</th>
      <th>Support Date</th>
    </tr>
    <tr>
      <td>US East (N. Virginia)</td>
      <td>us-east-1</td>
      <td>cloudtrail.us-east-1.amazonaws.com</td>
      <td>HTTPS</td>
      <td>11/13/2013</td>
    </tr>
    <tr>
      <td>US East (Ohio)</td>
      <td>us-east-2</td>
      <td>cloudtrail.us-east-2.amazonaws.com</td>
      <td>HTTPS</td>
      <td>10/17/2016</td>
    </tr>
    <tr>
      <td>US West (N. California)</td>
      <td>us-west-1</td>
      <td>cloudtrail.us-west-1.amazonaws.com</td>
      <td>HTTPS</td>
      <td>05/13/2014</td>
    </tr>
    <tr>
      <td>US West (Oregon)</td>
      <td>us-west-2</td>
      <td>cloudtrail.us-west-2.amazonaws.com</td>
      <td>HTTPS</td>
      <td>11/13/2013</td>
    </tr>
    <tr>
      <td>Canada (Central)</td>
      <td>ca-central-1</td>
      <td>cloudtrail.ca-central-1.amazonaws.com</td>
      <td>HTTPS</td>
      <td>12/08/2016</td>
    </tr>
    <tr>
      <td>Canada West (Calgary)</td>
      <td>ca-west-1</td>
      <td>cloudtrail.ca-west-1.amazonaws.com</td>
      <td>HTTPS</td>
      <td>12/20/2023</td>
    </tr>
      <tr>
        <td>Africa (Cape Town)</td>
        <td>af-south-1</td>
        <td>cloudtrail.af-south-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>04/22/2020</td>
      </tr>
      <tr>
        <td>Asia Pacific (Hong Kong)</td>
        <td>ap-east-1</td>
        <td>cloudtrail.ap-east-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>04/24/2019</td>
      </tr>
      <tr>
        <td>Asia Pacific (Mumbai)</td>
        <td>ap-south-1</td>
        <td>cloudtrail.ap-south-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>06/27/2016</td>
      </tr>
      <tr>
        <td>Asia Pacific (Hyderabad)</td>
        <td>ap-south-2</td>
        <td>cloudtrail.ap-south-2.amazonaws.com</td>
        <td>HTTPS</td>
        <td>11/22/2022</td>
      </tr>
      <tr>
        <td>Asia Pacific (Tokyo)</td>
        <td>ap-northeast-1</td>
        <td>cloudtrail.ap-northeast-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>06/30/2014</td>
      </tr>
      <tr>
        <td>Asia Pacific (Seoul)</td>
        <td>ap-northeast-2</td>
        <td>cloudtrail.ap-northeast-2.amazonaws.com</td>
        <td>HTTPS</td>
        <td>01/06/2016</td>
      </tr>
      <tr>
        <td>Asia Pacific (Osaka)</td>
        <td>ap-northeast-3</td>
        <td>cloudtrail.ap-northeast-3.amazonaws.com</td>
        <td>HTTPS</td>
        <td>02/12/2018</td>
      </tr>
      <tr>
        <td>Asia Pacific (Singapore)</td>
        <td>ap-southeast-1</td>
        <td>cloudtrail.ap-southeast-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>06/30/2014</td>
      </tr>
      <tr>
        <td>Asia Pacific (Sydney)</td>
        <td>ap-southeast-2</td>
        <td>cloudtrail.ap-southeast-2.amazonaws.com</td>
        <td>HTTPS</td>
        <td>05/13/2014</td>
      </tr>
      <tr>
        <td>Asia Pacific (Jakarta)</td>
        <td>ap-southeast-3</td>
        <td>cloudtrail.ap-southeast-3.amazonaws.com</td>
        <td>HTTPS</td>
        <td>12/13/2021</td>
      </tr>
      <tr>
        <td>Asia Pacific (Melbourne)</td>
        <td>ap-southeast-4</td>
        <td>cloudtrail.ap-southeast-4.amazonaws.com</td>
        <td>HTTPS</td>
        <td>01/23/2023</td>
      </tr>
      <tr>
        <td>China (Beijing)</td>
        <td>cn-north-1</td>
        <td>cloudtrail.cn-north-1.amazonaws.com.cn</td>
        <td>HTTPS</td>
        <td>03/01/2014</td>
      </tr>
      <tr>
        <td>China (Ningxia)</td>
        <td>cn-northwest-1</td>
        <td>cloudtrail.cn-northwest-1.amazonaws.com.cn</td>
        <td>HTTPS</td>
        <td>12/11/2017</td>
      </tr>
      <tr>
        <td>Europe (Frankfurt)</td>
        <td>eu-central-1</td>
        <td>cloudtrail.eu-central-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>10/23/2014</td>
      </tr>
      <tr>
        <td>Europe (Zurich)</td>
        <td>eu-central-2</td>
        <td>cloudtrail.eu-central-2.amazonaws.com</td>
        <td>HTTPS</td>
        <td>11/09/2022</td>
      </tr>
      <tr>
        <td>Europe (Stockholm)</td>
        <td>eu-north-1</td>
        <td>cloudtrail.eu-north-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>12/11/2018</td>
      </tr>
      <tr>
        <td>Europe (Ireland)</td>
        <td>eu-west-1</td>
        <td>cloudtrail.eu-west-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>05/13/2014</td>
      </tr>
      <tr>
        <td>Europe (London)</td>
        <td>eu-west-2</td>
        <td>cloudtrail.eu-west-2.amazonaws.com</td>
        <td>HTTPS</td>
        <td>12/13/2016</td>
      </tr>
      <tr>
        <td>Europe (Paris)</td>
        <td>eu-west-3</td>
        <td>cloudtrail.eu-west-3.amazonaws.com</td>
        <td>HTTPS</td>
        <td>12/18/2017</td>
      </tr>
      <tr>
        <td>Europe (Milan)</td>
        <td>eu-south-1</td>
        <td>cloudtrail.eu-south-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>04/27/2020</td>
      </tr>
      <tr>
        <td>Europe (Spain)</td>
        <td>eu-south-2</td>
        <td>cloudtrail.eu-south-2.amazonaws.com</td>
        <td>HTTPS</td>
        <td>11/16/2022</td>
      </tr>
      <tr>
        <td>Israel (Tel Aviv)</td>
        <td>il-central-1</td>
        <td>cloudtrail.il-central-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>07/31/2023</td>
      </tr>
      <tr>
        <td>Middle East (UAE)</td>
        <td>me-central-1</td>
        <td>cloudtrail.me-central-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>08/30/2022</td>
      </tr>
      <tr>
        <td>Middle East (Bahrain)</td>
        <td>me-south-1</td>
        <td>cloudtrail.me-south-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>07/29/2019</td>
      </tr>
      <tr>
        <td>AWS GovCloud (US-East)</td>
        <td>us-gov-east-1</td>
        <td>cloudtrail.us-gov-east-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>11/12/2018</td>
      </tr>
      <tr>
        <td>AWS GovCloud (US-West)</td>
        <td>us-gov-west-1</td>
        <td>cloudtrail.us-gov-west-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>08/16/2011</td>
      </tr>
      <tr>
        <td>South America (São Paulo)</td>
        <td>sa-east-1</td>
        <td>cloudtrail.sa-east-1.amazonaws.com</td>
        <td>HTTPS</td>
        <td>06/30/2014</td>
      </tr>

  </table>

</section>

<section>
    <h1>CloudTrail log file examples</h1>
    
    <p>CloudTrail monitors events for your account. If you create a trail, it delivers those events as log files to your Amazon S3 bucket. If you create an event data store in CloudTrail Lake, events are logged to your event data store. Event data stores do not use S3 buckets.</p>
    <ul>
    <li>CloudTrail log file name format</li>
    <li>Log file examples </li>
    </ul>
  </section>

  <section>
    <h1>CloudTrail log file name format</h1>
    <p>CloudTrail uses the following file name format for the log file objects that it delivers to your Amazon S3 bucket:</p>
    <pre>
      AccountID_CloudTrail_RegionName_YYYYMMDDTHHmmZ_UniqueString.FileNameFormat
    </pre>
    <p>The YYYY, MM, DD, HH, and mm are the digits of the year, month, day, hour, and minute when the log file was delivered. Hours are in 24-hour format. The Z indicates that the time is in UTC.</p>
    <p>The 16-character UniqueString component of the log file name is there to prevent overwriting of files. It has no meaning, and log processing software should ignore it.</p>
    <p>FileNameFormat is the encoding of the file. Currently, this is json.gz, which is a JSON text file in compressed gzip format.</p>
    <h2>Example CloudTrail Log File Name:</h2>
    <pre>
        111122223333_CloudTrail_us-east-2_20150801T0210Z_Mu0KsOhtH1ar15ZZ.json.gz
   </pre>
  </section>

  <section>
   <h1>Log file examples</h1>
   <P>A log file contains one or more records. The following examples are snippets of logs that show the records for an action that started the creation of a log file.</P>
   <h1>Contents</h1>
   <ul>
   <li>Amazon EC2 log examples</li>
  <li>IAM log examples</li>
  <li>Error code and message log example</li>
  <li>CloudTrail Insights event log example</li>
  </ul>

   <h1>1. Amazon EC2 log examples</h1>
   <p>Amazon EC2 provides resizeable computing capacity in the AWS Cloud. You can launch virtual servers, configure security and networking, and manage storage. EC2 can also scale up or down quickly to handle changes in requirements or spikes in popularity, reducing the need to forecast server traffic.</p>

   <h2>Example:</h2> The following example shows that an IAM user named Mateo ran the <code>aws ec2 start-instances</code> command to call the Amazon EC2 <code>StartInstances</code> action for instances <code>i-EXAMPLE56126103cb</code> and <code>i-EXAMPLEaff4840c22</code>.
   
<pre>
{"Records": [{
    "eventVersion": "1.08",
    "userIdentity": {
        "type": "IAMUser",
        "principalId": "EXAMPLE6E4XEGITWATV6R",
        "arn": "arn:aws:iam::123456789012:user/Mateo",
        "accountId": "123456789012",
        "accessKeyId": "AKIAIOSFODNN7EXAMPLE",
        "userName": "Mateo",
        "sessionContext": {
            "sessionIssuer": {},
            "webIdFederationData": {},
            "attributes": {
                "creationDate": "2023-07-19T21:11:57Z",
                "mfaAuthenticated": "false"
            }
        }
    },
    "eventTime": "2023-07-19T21:17:28Z",
    "eventSource": "ec2.amazonaws.com",
    "eventName": "StartInstances",
    "awsRegion": "us-east-1",
    "sourceIPAddress": "192.0.2.0",
    "userAgent": "aws-cli/2.13.5 Python/3.11.4 Linux/4.14.255-314-253.539.amzn2.x86_64 exec-env/CloudShell exe/x86_64.amzn.2 prompt/off command/ec2.start-instances",
    "requestParameters": {
        "instancesSet": {
            "items": [
                {
                    "instanceId": "i-EXAMPLE56126103cb"
                },
                {
                    "instanceId": "i-EXAMPLEaff4840c22"
                }
            ]
        }
    },
    "responseElements": {
        "requestId": "e4336db0-149f-4a6b-844d-EXAMPLEb9d16",
        "instancesSet": {
            "items": [
                {
                    "instanceId": "i-EXAMPLEaff4840c22",
                    "currentState": {
                        "code": 0,
                        "name": "pending"
                    },
                    "previousState": {
                        "code": 80,
                        "name": "stopped"
                    }
                },
                {
                    "instanceId": "i-EXAMPLE56126103cb",
                    "currentState": {
                        "code": 0,
                        "name": "pending"
                    },
                    "previousState": {
                        "code": 80,
                        "name": "stopped"
                    }
                }
            ]
        }
    },
    "requestID": "e4336db0-149f-4a6b-844d-EXAMPLEb9d16",
    "eventID": "e755e09c-42f9-4c5c-9064-EXAMPLE228c7",
    "readOnly": false,
    "eventType": "AwsApiCall",
    "managementEvent": true,
    "recipientAccountId": "123456789012",
    "eventCategory": "Management",
     "tlsDetails": {
        "tlsVersion": "TLSv1.2",
        "cipherSuite": "ECDHE-RSA-AES128-GCM-SHA256",
        "clientProvidedHostHeader": "ec2.us-east-1.amazonaws.com"
    },
    "sessionCredentialFromConsole": "true"
}]}
</pre>
<p>The following example shows that an IAM user named Nikki ran the aws ec2 stop-instances command to call the Amazon EC2 StopInstances action to stop two instances.</p>

<pre>
{"Records": [{
    "eventVersion": "1.08",
    "userIdentity": {
        "type": "IAMUser",
        "principalId": "EXAMPLE6E4XEGITWATV6R",
        "arn": "arn:aws:iam::777788889999:user/Nikki",
        "accountId": "777788889999",
        "accessKeyId": "AKIAI44QH8DHBEXAMPLE",
        "userName": "Nikki",
        "sessionContext": {
            "sessionIssuer": {},
            "webIdFederationData": {},
            "attributes": {
                "creationDate": "2023-07-19T21:11:57Z",
                "mfaAuthenticated": "false"
            }
        }
    },
    "eventTime": "2023-07-19T21:14:20Z",
    "eventSource": "ec2.amazonaws.com",
    "eventName": "StopInstances",
    "awsRegion": "us-east-1",
    "sourceIPAddress": "192.0.2.0",
    "userAgent": "aws-cli/2.13.5 Python/3.11.4 Linux/4.14.255-314-253.539.amzn2.x86_64 exec-env/CloudShell exe/x86_64.amzn.2 prompt/off command/ec2.stop-instances",
    "requestParameters": {
        "instancesSet": {
            "items": [
                {
                    "instanceId": "i-EXAMPLE56126103cb"
                },
                {
                    "instanceId": "i-EXAMPLEaff4840c22"
                }
            ]
        },
        "force": false
    },
    "responseElements": {
        "requestId": "c308a950-e43e-444e-afc1-EXAMPLE73e49",
        "instancesSet": {
            "items": [
                {
                    "instanceId": "i-EXAMPLE56126103cb",
                    "currentState": {
                        "code": 64,
                        "name": "stopping"
                    },
                    "previousState": {
                        "code": 16,
                        "name": "running"
                    }
                },
                {
                    "instanceId": "i-EXAMPLEaff4840c22",
                    "currentState": {
                        "code": 64,
                        "name": "stopping"
                    },
                    "previousState": {
                        "code": 16,
                        "name": "running"
                    }
                }
            ]
        }
    },
    "requestID": "c308a950-e43e-444e-afc1-EXAMPLE73e49",
    "eventID": "9357a8cc-a0eb-46a1-b67e-EXAMPLE19b14",
    "readOnly": false,
    "eventType": "AwsApiCall",
    "managementEvent": true,
    "recipientAccountId": "777788889999",
    "eventCategory": "Management",
     "tlsDetails": {
        "tlsVersion": "TLSv1.2",
        "cipherSuite": "ECDHE-RSA-AES128-GCM-SHA256",
        "clientProvidedHostHeader": "ec2.us-east-1.amazonaws.com"
    },
    "sessionCredentialFromConsole": "true"
}]}
</pre>

<p>The following example shows that an IAM user named Arnav ran the aws ec2 create-key-pair command to call the CreateKeyPair action. Note that the responseElements contain a hash of the key pair and that AWS removed the key material.</p>

<pre>
{"Records": [{
    "eventVersion": "1.08",
    "userIdentity": {
        "type": "IAMUser",
        "principalId": "AIDA6ON6E4XEGIEXAMPLE",
        "arn": "arn:aws:iam::444455556666:user/Arnav",
        "accountId": "444455556666",
        "accessKeyId": "AKIAI44QH8DHBEXAMPLE",
        "userName": "Arnav",
        "sessionContext": {
            "sessionIssuer": {},
            "webIdFederationData": {},
            "attributes": {
                "creationDate": "2023-07-19T21:11:57Z",
                "mfaAuthenticated": "false"
            }
        }
    },
    "eventTime": "2023-07-19T21:19:22Z",
    "eventSource": "ec2.amazonaws.com",
    "eventName": "CreateKeyPair",
    "awsRegion": "us-east-1",
    "sourceIPAddress": "192.0.2.0",
    "userAgent": "aws-cli/2.13.5 Python/3.11.4 Linux/4.14.255-314-253.539.amzn2.x86_64 exec-env/CloudShell exe/x86_64.amzn.2 prompt/off command/ec2.create-key-pair",
    "requestParameters": {
        "keyName": "my-key",
        "keyType": "rsa",
        "keyFormat": "pem"
    },
    "responseElements": {
        "requestId": "9aa4938f-720f-4f4b-9637-EXAMPLE9a196",
        "keyName": "my-key",
        "keyFingerprint": "1f:51:ae:28:bf:89:e9:d8:1f:25:5d:37:2d:7d:b8:ca:9f:f5:f1:6f",
        "keyPairId": "key-abcd12345eEXAMPLE",
        "keyMaterial": "<sensitiveDataRemoved>"
    },
    "requestID": "9aa4938f-720f-4f4b-9637-EXAMPLE9a196",
    "eventID": "2ae450ff-e72b-4de1-87b0-EXAMPLE5227cb",
    "readOnly": false,
    "eventType": "AwsApiCall",
    "managementEvent": true,
    "recipientAccountId": "444455556666",
    "eventCategory": "Management",
    "tlsDetails": {
        "tlsVersion": "TLSv1.2",
        "cipherSuite": "ECDHE-RSA-AES128-GCM-SHA256",
        "clientProvidedHostHeader": "ec2.us-east-1.amazonaws.com"
    },
    "sessionCredentialFromConsole": "true"
}]}
</pre>


<h1>2. IAM log examples</h1>
<p>AWS Identity and Access Management (IAM) is a web service that helps you securely control access to AWS resources. With IAM, you can centrally manage permissions that control which AWS resources users can access. You use IAM to control who is authenticated (signed in) and authorized (has permissions) to use resources. For more information, see the IAM User Guide.</p>

<p>The following example shows that the IAM user named Mary ran the aws iam create-user command to call the CreateUser action to create a new user named Richard.</p>

<pre>
{"Records": [{
    "eventVersion": "1.08",
    "userIdentity": {
        "type": "IAMUser",
        "principalId": "AIDA6ON6E4XEGITEXAMPLE",
        "arn": "arn:aws:iam::888888888888:user/Mary",
        "accountId": "888888888888",
        "accessKeyId": "AKIAIOSFODNN7EXAMPLE",
        "userName": "Mary",
        "sessionContext": {
            "sessionIssuer": {},
            "webIdFederationData": {},
            "attributes": {
                "creationDate": "2023-07-19T21:11:57Z",
                "mfaAuthenticated": "false"
            }
        }
    },
    "eventTime": "2023-07-19T21:25:09Z",
    "eventSource": "iam.amazonaws.com",
    "eventName": "CreateUser",
    "awsRegion": "us-east-1",
    "sourceIPAddress": "192.0.2.0",
    "userAgent": "aws-cli/2.13.5 Python/3.11.4 Linux/4.14.255-314-253.539.amzn2.x86_64 exec-env/CloudShell exe/x86_64.amzn.2 prompt/off command/iam.create-user",
    "requestParameters": {
        "userName": "Richard"
    },
    "responseElements": {
        "user": {
            "path": "/",
            "arn": "arn:aws:iam::888888888888:user/Richard",
            "userId": "AIDA6ON6E4XEP7EXAMPLE",
            "createDate": "Jul 19, 2023 9:25:09 PM",
            "userName": "Richard"
        }
    },
    "requestID": "2d528c76-329e-410b-9516-EXAMPLE565dc",
    "eventID": "ba0801a1-87ec-4d26-be87-EXAMPLE75bbb",
    "readOnly": false,
    "eventType": "AwsApiCall",
    "managementEvent": true,
    "recipientAccountId": "888888888888",
    "eventCategory": "Management",
    "tlsDetails": {
        "tlsVersion": "TLSv1.2",
        "cipherSuite": "ECDHE-RSA-AES128-GCM-SHA256",
        "clientProvidedHostHeader": "iam.amazonaws.com"
    },
    "sessionCredentialFromConsole": "true"
}]}  
</pre>     

<p>The following example shows that the IAM user named Paulo ran the aws iam add-user-to-group command to call the AddUserToGroup action to add a user named Jane to the Admin group.</p>

<pre>
{"Records": [{
    "eventVersion": "1.08",
    "userIdentity": {
        "type": "IAMUser",
        "principalId": "AIDA6ON6E4XEGIEXAMPLE",
        "arn": "arn:aws:iam::555555555555:user/Paulo",
        "accountId": "555555555555",
        "accessKeyId": "AKIAIOSFODNN7EXAMPLE",
        "userName": "Paulo",
        "sessionContext": {
            "sessionIssuer": {},
            "webIdFederationData": {},
            "attributes": {
                "creationDate": "2023-07-19T21:11:57Z",
                "mfaAuthenticated": "false"
            }
        }
    },
    "eventTime": "2023-07-19T21:25:09Z",
    "eventSource": "iam.amazonaws.com",
    "eventName": "AddUserToGroup",
    "awsRegion": "us-east-1",
    "sourceIPAddress": "192.0.2.0",
    "userAgent": "aws-cli/2.13.5 Python/3.11.4 Linux/4.14.255-314-253.539.amzn2.x86_64 exec-env/CloudShell exe/x86_64.amzn.2 prompt/off command/iam.add-user-to-group",
    "requestParameters": {
        "groupName": "Admin",
        "userName": "Jane"
    },
    "responseElements": null,
    "requestID": "ecd94349-b36f-44bf-b6f5-EXAMPLE9c463",
    "eventID": "2939ba50-1d26-4a5a-83bd-EXAMPLE85850",
    "readOnly": false,
    "eventType": "AwsApiCall",
    "managementEvent": true,
    "recipientAccountId": "555555555555",
    "eventCategory": "Management",
    "tlsDetails": {
        "tlsVersion": "TLSv1.2",
        "cipherSuite": "ECDHE-RSA-AES128-GCM-SHA256",
        "clientProvidedHostHeader": "iam.amazonaws.com"
    },
    "sessionCredentialFromConsole": "true"
}]}
</pre>
<p>The following example shows that the IAM user named Saanvi ran the aws iam create-role command to call the CreateRole action to create a role.</p>

<pre>
{"Records": [{
    "eventVersion": "1.08",
    "userIdentity": {
        "type": "IAMUser",
        "principalId": "AIDA6ON6E4XEGITEXAMPLE",
        "arn": "arn:aws:iam::777777777777:user/Saanvi",
        "accountId": "777777777777",
        "accessKeyId": "AKIAIOSFODNN7EXAMPLE",
        "userName": "Saanvi",
        "sessionContext": {
            "sessionIssuer": {},
            "webIdFederationData": {},
            "attributes": {
                "creationDate": "2023-07-19T21:11:57Z",
                "mfaAuthenticated": "false"
            }
        }
    },
    "eventTime": "2023-07-19T21:29:12Z",
    "eventSource": "iam.amazonaws.com",
    "eventName": "CreateRole",
    "awsRegion": "us-east-1",
    "sourceIPAddress": "192.0.2.0",
    "userAgent": "aws-cli/2.13.5 Python/3.11.4 Linux/4.14.255-314-253.539.amzn2.x86_64 exec-env/CloudShell exe/x86_64.amzn.2 prompt/off command/iam.create-role",
    "requestParameters": {
        "roleName": "TestRole",
        "description": "Allows EC2 instances to call AWS services on your behalf.",
        "assumeRolePolicyDocument": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"sts:AssumeRole\"],\"Principal\":{\"Service\":[\"ec2.amazonaws.com\"]}}]}"
    },
    "responseElements": {
        "role": {
            "assumeRolePolicyDocument": "%7B%22Version%22%3A%222012-10-17%22%2C%22Statement%22%3A%5B%7B%22Effect%22%3A%22Allow%22%2C%22Action%22%3A%5B%22sts%3AAssumeRole%22%5D%2C%22Principal%22%3A%7B%22Service%22%3A%5B%22ec2.amazonaws.com%22%5D%7D%7D%5D%7D",
            "arn": "arn:aws:iam::777777777777:role/TestRole",
            "roleId": "AROA6ON6E4XEFFEXAMPLE",
            "createDate": "Jul 19, 2023 9:29:12 PM",
            "roleName": "TestRole",
            "path": "/"
        }
    },
    "requestID": "ff38f36e-ebd3-425b-9939-EXAMPLE1bbe",
    "eventID": "9da77cd0-493f-4c89-8852-EXAMPLEa887c",
    "readOnly": false,
    "eventType": "AwsApiCall",
    "managementEvent": true,
    "recipientAccountId": "777777777777",
    "eventCategory": "Management",
    "tlsDetails": {
        "tlsVersion": "TLSv1.2",
        "cipherSuite": "ECDHE-RSA-AES128-GCM-SHA256",
        "clientProvidedHostHeader": "iam.amazonaws.com"
    },
    "sessionCredentialFromConsole": "true"
}]}
</pre>

<h1>3. Error code and message log example</h1>
  <p>The following example shows that the IAM user named Terry ran the aws cloudtrail update-trail command to call the UpdateTrail action to update a trail named myTrail2, but the trail name was not found. The log shows this error in the errorCode and errorMessage elements.</p>
  
  <pre>
  {"Records": [{
      "eventVersion": "1.09",
      "userIdentity": {
          "type": "IAMUser",
          "principalId": "AIDA6ON6E4XEGIEXAMPLE",
          "arn": "arn:aws:iam::111122223333:user/Terry",
          "accountId": "111122223333",
          "accessKeyId": "AKIAIOSFODNN7EXAMPLE",
          "userName": "Terry",
          "sessionContext": {
              "attributes": {
                  "creationDate": "2023-07-19T21:11:57Z",
                  "mfaAuthenticated": "false"
              }
          }
      },
      "eventTime": "2023-07-19T21:35:03Z",
      "eventSource": "cloudtrail.amazonaws.com",
      "eventName": "UpdateTrail",
      "awsRegion": "us-east-1",
      "sourceIPAddress": "192.0.2.0",
      "userAgent": "aws-cli/2.13.0 Python/3.11.4 Linux/4.14.255-314-253.539.amzn2.x86_64 exec-env/CloudShell exe/x86_64.amzn.2 prompt/off command/cloudtrail.update-trail",
      "errorCode": "TrailNotFoundException",
      "errorMessage": "Unknown trail: arn:aws:cloudtrail:us-east-1:111122223333:trail/myTrail2 for the user: 111122223333",
      "requestParameters": {
          "name": "myTrail2",
          "isMultiRegionTrail": true
      },
      "responseElements": null,
      "requestID": "28d2faaf-3319-4649-998d-EXAMPLE72818",
      "eventID": "694d604a-d190-4470-8dd1-EXAMPLEe20c1",
      "readOnly": false,
      "eventType": "AwsApiCall",
      "managementEvent": true,
      "recipientAccountId": "111122223333",
      "eventCategory": "Management",
      "tlsDetails": {
          "tlsVersion": "TLSv1.2",
          "cipherSuite": "ECDHE-RSA-AES128-GCM-SHA256",
          "clientProvidedHostHeader": "cloudtrail.us-east-1.amazonaws.com"
      },
      "sessionCredentialFromConsole": "true"
  }]}   
</pre>
    
  <h1>4. CloudTrail Insights event log example</h1>
<p>The following example shows a CloudTrail Insights event log. An Insights event is actually a pair of events that mark the start and end of a period of unusual write management API activity or error response activity. The state field shows whether the event was logged at the start or end of the period of unusual activity. The event name, UpdateInstanceInformation, is the same name as the AWS Systems Manager API for which CloudTrail analyzed management events to determine that unusual activity occurred. Although the start and end events have unique eventID values, they also have a sharedEventID value that is used by the pair. The Insights event shows the baseline, or the normal pattern of activity, the insight, or average unusual activity that triggered the start Insights event, and in the end event, the insight value for the average unusual activity over the duration of the Insights event. For more information about CloudTrail Insights, see Logging Insights events.</p>
  
  <pre>
  {
      "Records": [{
          "eventVersion": "1.08",
          "eventTime": "2023-01-02T02:51:00Z",
          "awsRegion": "us-east-1",
          "eventID": "654a30ff-b0f3-4527-81b6-EXAMPLEf2393",
          "eventType": "AwsCloudTrailInsight",
          "recipientAccountId": "123456789012",
          "sharedEventID": "bcbfc274-8559-4a56-beb0-EXAMPLEa6c34",
          "insightDetails": {
              "state": "Start",
              "eventSource": "ssm.amazonaws.com",
              "eventName": "UpdateInstanceInformation",
              "insightType": "ApiCallRateInsight",
              "insightContext": {
                  "statistics": {
                      "baseline": {
                          "average": 84.410596421
                      },
                      "insight": {
                          "average": 669
                      }
                  }
              }
          },
          "eventCategory": "Insight"
      },
      {
          "eventVersion": "1.08",
          "eventTime": "2023-01-02T00:22:00Z",
          "awsRegion": "us-east-1",
          "eventID": "258de2fb-e2a9-4fb5-aeb2-EXAMPLE449a4",
          "eventType": "AwsCloudTrailInsight",
          "recipientAccountId": "123456789012",
          "sharedEventID": "8b74a7bc-d5d3-4d19-9d60-EXAMPLE08b51",
          "insightDetails": {
              "state": "End",
              "eventSource": "ssm.amazonaws.com",
              "eventName": "UpdateInstanceInformation",
              "insightType": "ApiCallRateInsight",
              "insightContext": {
                  "statistics": {
                      "baseline": {
                          "average": 74.156423842
                      },
                      "insight": {
                          "average": 657
                      },
                      "insightDuration": 1
                  }
              }
          },
          "eventCategory": "Insight"
      }]
  }
</pre>

</section>